name: Check current branch

on:
  push:
    branches:
      - 'topic-branch-*' # topic-branch- で始まるブランチへのプッシュでトリガー
      - 'feature/**'     # feature/ 以下のブランチへのプッシュでもトリガー
  pull_request:
    branches:
      - '**'             # 全てのプルリクエストでトリガー
  workflow_dispatch:     # 手動実行を許可

jobs:
  check-branch-job:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          # ローカルのワークフロー実行ツール (例: act) で使用する場合、
          # リポジトリのコードを仮想環境に持ってきます。
          fetch-depth: 0 # ブランチ履歴全体を取得したい場合は 0 を指定

      - name: Determine and log the branch name
        run: |
          # GitHub Actionsのデフォルト環境変数を使ってブランチ名を取得
          echo "GitHub Actions Ref: $GITHUB_REF"
          echo "GitHub Actions Head Ref: $GITHUB_HEAD_REF"
          echo "GitHub Actions Base Ref: $GITHUB_BASE_REF"

          # どのブランチで実行されているかをより明確に判断するロジック例
          BRANCH_NAME=""
          if [ -n "$GITHUB_HEAD_REF" ]; then
            BRANCH_NAME="$GITHUB_HEAD_REF" # PRの場合
          else
            BRANCH_NAME="${GITHUB_REF#refs/heads/}" # pushの場合
          fi
          echo "Processing branch: $BRANCH_NAME"

          # 特定のトピックブランチかをチェックする条件分岐の例
          if [[ "$BRANCH_NAME" == topic-branch-featureA ]]; then
            echo "これは Feature A のトピックブランチです。特別な処理を実行します。"
            # ここに特別なコマンドを記述
          else
            echo "これは他のブランチです。"
          fi
